## Funktsioon konverdib x ja y koordinaadid lat long koordinaatideks
## sisendiks on dataframe kus on vastavalt veerud nimega x ja y
## väljund on sama dataframe koos kahe uue veeruga lat ja lon
## Telia aadresside x ja y koordinaadid saab kätte vaatest MATRIX.G_Objekt_aadress

library(dplyr)

x_y_to_lat_lon <- function(df){
  df %>% 
    mutate(z = ((((x / 100 - 500000) ^ 2 + (4020205.47869775 - (y / 100 - 6375000)) * (4020205.47869775 - (y /100 - 6375000))) ^ 0.5) / (6378137 * 0.531199537556459 / ((log(0.531199537556459) - log(0.511310391280668)) / (log(0.288380548794698) - log(0.275780500192991)) * 0.288380548794698 ^ ((log(0.531199537556459) - log(0.511310391280668)) / (log(0.288380548794698) - log(0.275780500192991)))))) ^ (1 / ((log(0.531199537556459) - log(0.511310391280668)) / (log(0.288380548794698) - log(0.275780500192991)))),
           lat = ((((3.14159265358979 / 2) - (2 * atan(z))) + (0.00669438002290341 / 2 + (5 * 0.00669438002290341 ^ 2 / 24) + (0.00669438002290341 ^ 3 / 12) + (13 * 0.00669438002290341 ^ 4 / 360)) * sin(2 * ((3.14159265358979 / 2) - (2 * atan(z)))) + ((7 * 0.00669438002290341 ^ 2 / 48) + (29 * 0.00669438002290341 ^ 3 / 240) + (811 * 0.00669438002290341^ 4 / 11520)) * sin(4 * ((3.14159265358979 / 2) - (2 * atan(z)))) + ((7 * 0.00669438002290341 ^ 3 / 120) + (81 * 0.00669438002290341 ^ 4 / 1120)) * sin(6 * ((3.14159265358979 / 2) - (2 * atan(z)))) + (4279 * 0.00669438002290341 ^ 4 / 161280) * sin(8 * ((3.14159265358979 / 2) - (2 * atan(z))))) * 57.2957795130823),
           lon = ((atan((x / 100 - 500000) / (4020205.47869775 - (y / 100 - 6375000))) / ((log(0.531199537556459) - log(0.511310391280668)) / (log(0.288380548794698) - log(0.275780500192991))) + 24 / 57.2957795130823) * 57.2957795130823)) %>% 
    select(-z)
}